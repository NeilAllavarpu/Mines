(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1:function(e){e.exports={a:{INPUT:-1,IN_PROGRESS:0,LOSS:1,PAUSE:3,WIN:2},b:{HIDDEN:0,MARKED:1,REVEALED:2}}},12:function(e,t,n){e.exports=n(19)},17:function(e,t,n){},19:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),s=n(9),r=n.n(s),u=n(7),l=n(2),o=n(3),h=n(5),c=n(4),m=n(6),d=(n(17),n(10)),p=n(11),f=n(1);function v(e){var t=e.mine,n=e.mineSize,a=e.handleClick,s=e.handleRightClick,r="mine ".concat(t.customClasses),u=null;return t.state===f.b.REVEALED?!0===t.isMine?(r+=" mineLoss",u="X"):(r+=" mineNum".concat(t.minesNear),0!==t.minesNear&&(u=t.minesNear)):t.state===f.b.MARKED&&(u="!"),i.a.createElement("div",{className:r,onClick:a,onContextMenu:s,style:{fontSize:n,height:n,lineHeight:n,width:n}},i.a.createElement("div",{className:"label"},u))}var E=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(h.a)(this,Object(c.a)(t).call(this,e))).start=Date.now(),n.state={last:Date.now(),timePassed:0},n.requestID=null,n}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.requestID=window.requestAnimationFrame(function(){e.updateTimer()})}},{key:"updateTimer",value:function(){var e=this;this.setState(function(e){return{last:Date.now(),timePassed:e.timePassed+(Date.now()-e.last)}},function(){!0===e.props.running&&window.requestAnimationFrame(e.updateTimer.bind(e))})}},{key:"componentWillUnmount",value:function(){window.cancelAnimationFrame(this.requestID)}},{key:"resume",value:function(){var e=this;this.setState({last:Date.now()},function(){window.requestAnimationFrame(e.updateTimer.bind(e))})}},{key:"render",value:function(){if(!0===this.props.display){var e=Math.floor(this.state.timePassed/1e3),t=Math.floor(e/60),n=(e%60).toLocaleString([],{minimumIntegerDigits:2});return i.a.createElement("div",null,"Time: ",t,":",n)}return null}}]),t}(i.a.Component),b=function(e){function t(e){var n;Object(l.a)(this,t);var a=[];(n=Object(h.a)(this,Object(c.a)(t).call(this,e))).timer=i.a.createRef(),n.markedNum=0;for(var s=0;s<e.height;++s){a.push([]);for(var r=0;r<e.width;++r)a[s].push({customClasses:"",isMine:!1,minesNear:0,state:f.b.HIDDEN})}return n.firstClick=!0,n.state={mines:a},n}return Object(m.a)(t,e),Object(o.a)(t,[{key:"getMinesToTest",value:function(e,t){var n=[];return e>0&&(t>0&&n.push([e-1,t-1]),n.push([e-1,t]),t<this.props.height-1&&n.push([e-1,t+1])),t>0&&n.push([e,t-1]),t<this.props.height-1&&n.push([e,t+1]),e<this.props.width-1&&(t>0&&n.push([e+1,t-1]),n.push([e+1,t]),t<this.props.height-1&&n.push([e+1,t+1])),n}},{key:"revealNear",value:function(e,t,n){var a=this,i=!1,s=Object(p.a)(e),r=this.getMinesToTest(t,n),u=r.reduce(function(t,n){return e[n[1]][n[0]].state===f.b.MARKED?t+1:t},0);return s[n][t].minesNear===u&&(r.forEach(function(e){var t=s[e[1]][e[0]];t.state!==f.b.MARKED||t.isMine||(i=!0,t.customClasses="mineLossAutoClick",i=t)}),!1===i&&r.forEach(function(t){if(!1===i){var n=e[t[1]][t[0]];if(n.state===f.b.HIDDEN)if(n.state=f.b.REVEALED,n.isMine)i=t,n.customClasses="mineLossAutoClick";else{var r=a.revealNear(s,t[0],t[1]);!1===(i=r.mineRevealed)&&(s=r.mines)}}},this)),{mineRevealed:i,mines:e}}},{key:"triggerLoss",value:function(){this.setState(function(e){return{mines:e.mines.map(function(e){return e.map(function(e){var t=Object(d.a)({},e);return!1===t.isMine&&t.state===f.b.MARKED&&(t.customClasses+=" falseMark"),t.state===f.b.HIDDEN&&(t.customClasses+=" after"),!1!==t.isMine&&t.state!==f.b.HIDDEN||(t.state=f.b.REVEALED),t})})}})}},{key:"handleClick",value:function(e,n){var a=this,i=this.state.mines;if(!0===this.firstClick)this.setState(function(t){for(var i=[],s=0;s<t.mines.length;++s)for(var r=0;r<t.mines[s].length;++r)r===e&&s===n||i.push([r,s]);for(var u=0;u<a.props.numMines;++u){var l=Math.floor(Math.random()*i.length),o=i[l];i.splice(l,1),t.mines[o[1]][o[0]].isMine=!0,a.getMinesToTest(o[0],o[1]).forEach(function(e){++t.mines[e[1]][e[0]].minesNear})}return{mines:t.mines}},function(){a.firstClick=!1,a.handleClick(e,n)});else if(this.props.playing===f.a.IN_PROGRESS&&this.state.mines[n][e].state!==f.b.MARKED)if(i[n][e].state=f.b.REVEALED,i[n][e].isMine)this.props.updateState({playing:f.a.LOSS}),i[n][e].customClasses+=" mineLossClick",this.setState({mines:i},this.triggerLoss);else{var s=this.revealNear(i,e,n);!0===s.mineRevealed?(this.props.updateState({playing:f.a.LOSS}),this.triggerLoss()):0===t.validSquaresLeft(s.mines)?(this.props.updateState({playing:f.a.WIN}),this.setState({mines:s.mines.map(function(e){return e.map(function(e){var t=e;return!0===t.isMine&&(t.state=f.b.MARKED),t})})})):this.setState({mines:s.mines})}}},{key:"handleRightClick",value:function(e,t){var n=this;if(this.props.playing===f.a.IN_PROGRESS){var a=this.state.mines[t][e];a.state!==f.b.REVEALED&&this.setState(function(i){return a.state===f.b.MARKED?(i.mines[t][e].state=f.b.HIDDEN,--n.markedNum):(i.mines[t][e].state=f.b.MARKED,++n.markedNum),{mines:i.mines}})}}},{key:"render",value:function(){var e,n,a,s,r,u,l=this,o=this.props,h=o.width,c=o.height,m=o.numMines,d=o.playing;(n=!0===this.firstClick?0:100-100*t.validSquaresLeft(this.state.mines)/(c*h-m),d===f.a.PAUSE)?e=i.a.createElement("div",null,"Paused",i.a.createElement("br",null),i.a.createElement("button",{onClick:function(){l.props.updateState({playing:f.a.IN_PROGRESS}),l.timer.resume()}},"Resume")):(d===f.a.IN_PROGRESS?(s=i.a.createElement("div",{className:"status"},i.a.createElement("div",null,"Mines Left: ",Math.max(this.props.numMines-this.markedNum,0)),i.a.createElement("div",null,"Progress:",i.a.createElement("div",{className:"bar"},i.a.createElement("div",{className:"innerBar",style:{width:"".concat(n,"%")}},Math.round(10*n)/10,"%")))),a=i.a.createElement("button",{onClick:this.props.updateState.bind(this,{playing:f.a.PAUSE})},"Pause")):a=i.a.createElement("button",{onClick:this.props.updateState.bind(this,{playing:f.a.INPUT})},"Restart"),d===f.a.WIN?r=i.a.createElement("div",{className:"status win"},"Good job!"):d===f.a.LOSS&&(r=i.a.createElement("div",{className:"status"},"You lost!")),u=80/this.props.width<80/this.props.height?"".concat(80/this.props.width,"vw"):"".concat(80/this.props.height,"vh"),e=i.a.createElement("div",null,i.a.createElement("div",{className:"board"},this.state.mines.map(function(e,t){return i.a.createElement("div",{className:"row",key:t},e.map(function(e,n){return i.a.createElement(v,{key:n,mine:e,handleClick:function(){l.handleClick(n,t)},mineSize:u,handleRightClick:function(e){e.preventDefault(),l.handleRightClick(n,t)}})}))})),s,r,a));return i.a.createElement("div",null,i.a.createElement(E,{running:d===f.a.IN_PROGRESS,display:d!==f.a.PAUSE,ref:function(e){l.timer=e}}),e)}}],[{key:"validSquaresLeft",value:function(e){return e.reduce(function(e,t){return e+t.reduce(function(e,t){return t.state===f.b.HIDDEN&&!1===t.isMine?e+1:e},0)},0)}}]),t}(i.a.Component);function g(e){var t=e.handleInputChange,n=e.handleSubmit,a=e.height,s=e.numMines,r=e.width;return i.a.createElement("form",{onSubmit:n.bind(this)},i.a.createElement("label",null,"Board width ",i.a.createElement("input",{type:"number",min:1,max:Math.floor(window.innerWidth/6),value:r,onChange:t.bind(this,"width")})),i.a.createElement("label",null,"Board height ",i.a.createElement("input",{type:"number",min:1,value:a,onChange:t.bind(this,"height")})),i.a.createElement("label",null,"Number of mines ",i.a.createElement("input",{type:"number",min:1,max:r*a-1,value:s,onChange:t.bind(this,"numMines")})),i.a.createElement("input",{type:"submit",value:"Play!"}))}var S=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(h.a)(this,Object(c.a)(t).call(this,e))).state={height:15,numMines:75,playing:f.a.INPUT,width:30},n}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("blur",function(){e.state.playing===f.a.IN_PROGRESS&&e.setState({playing:f.a.PAUSE})})}},{key:"updateState",value:function(e){this.setState(e)}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.setState({playing:f.a.IN_PROGRESS})}},{key:"handleInputChange",value:function(e,t){this.setState(Object(u.a)({},e,t.target.value))}},{key:"render",value:function(){return this.state.playing===f.a.INPUT?i.a.createElement(g,{width:this.state.width,height:this.state.height,numMines:this.state.numMines,handleSubmit:this.handleSubmit.bind(this),handleInputChange:this.handleInputChange.bind(this)}):i.a.createElement(b,{width:this.state.width,height:this.state.height,numMines:this.state.numMines,playing:this.state.playing,updateState:this.updateState.bind(this)})}}]),t}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(i.a.createElement(S,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[12,2,1]]]);
//# sourceMappingURL=main.8b0f8a35.chunk.js.map