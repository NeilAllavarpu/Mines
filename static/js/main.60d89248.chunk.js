(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1:function(e){e.exports={a:{INPUT:-1,IN_PROGRESS:0,LOSS:1,PAUSE:3,WIN:2},b:{HIDDEN:0,MARKED:1,REVEALED:2}}},11:function(e,t,a){e.exports=a(18)},16:function(e,t,a){},18:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),s=a(9),r=a.n(s),l=a(7),o=a(2),u=a(3),h=a(5),m=a(4),c=a(6),d=(a(16),a(10)),p=a(1);function f(e){var t=e.mine,a=e.mineSize,n=e.handleClick,s=e.handleRightClick,r="mine ".concat(t.customClasses),l=null;return t.state===p.b.REVEALED?!0===t.isMine?(r+=" mineLoss",l="X"):(r+=" mineNum".concat(t.minesNear),0!==t.minesNear&&(l=t.minesNear)):t.state===p.b.MARKED&&(l="!"),i.a.createElement("div",{className:r,onClick:n,onContextMenu:s,style:{fontSize:a,height:a,lineHeight:a,width:a}},i.a.createElement("div",{className:"label"},l))}var g=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(h.a)(this,Object(m.a)(t).call(this,e))).start=Date.now(),a.state={last:Date.now(),timePassed:0},a.requestID=null,a}return Object(c.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.requestID=window.requestAnimationFrame(function(){e.updateTimer()})}},{key:"updateTimer",value:function(){var e=this;this.setState(function(e){return{last:Date.now(),timePassed:e.timePassed+(Date.now()-e.last)}},function(){!0===e.props.running&&window.requestAnimationFrame(e.updateTimer.bind(e))})}},{key:"componentWillUnmount",value:function(){window.cancelAnimationFrame(this.requestID)}},{key:"resume",value:function(){var e=this;this.setState({last:Date.now()},function(){window.requestAnimationFrame(e.updateTimer.bind(e))})}},{key:"getTime",value:function(){return this.state.timePassed/1e3}},{key:"render",value:function(){if(!0===this.props.display){var e=Math.floor(this.state.timePassed/1e3),t=Math.floor(e/60),a=(e%60).toLocaleString([],{minimumIntegerDigits:2});return i.a.createElement("div",null,"Time: ",t,":",a)}return null}}]),t}(i.a.Component),b=function(e){function t(){return Object(o.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=localStorage.getItem("scores");return e?(e=e.split(","),i.a.createElement("div",null,i.a.createElement("h2",null,"Fastest Times"),i.a.createElement("ol",null,e.map(function(e){return i.a.createElement("li",null,Math.floor(e/60),":",(e%60).toLocaleString([],{minimumIntegerDigits:2}))})),i.a.createElement("button",{onClick:this.props.updateState.bind(this,{playing:p.a.INPUT})},"Restart"))):i.a.createElement("div",null,"Play to get some times here!")}}]),t}(i.a.Component),v=function(e){function t(e){var a;Object(o.a)(this,t);var n=[];(a=Object(h.a)(this,Object(m.a)(t).call(this,e))).timer=i.a.createRef(),a.markedNum=0;for(var s=0;s<e.height;++s){n.push([]);for(var r=0;r<e.width;++r)n[s].push({customClasses:"",isMine:!1,minesNear:0,state:p.b.HIDDEN})}return a.firstClick=!0,a.state={mines:n,hasFinished:!1,showHelp:!1},a}return Object(c.a)(t,e),Object(u.a)(t,[{key:"getMinesToTest",value:function(e,t){var a=[];return e>0&&(t>0&&a.push([e-1,t-1]),a.push([e-1,t]),t<this.props.height-1&&a.push([e-1,t+1])),t>0&&a.push([e,t-1]),t<this.props.height-1&&a.push([e,t+1]),e<this.props.width-1&&(t>0&&a.push([e+1,t-1]),a.push([e+1,t]),t<this.props.height-1&&a.push([e+1,t+1])),a}},{key:"revealNear",value:function(e,t,a){var n=this.getMinesToTest(t,a),i=n.reduce(function(t,a){return e[a[1]][a[0]].state===p.b.MARKED?t+1:t},0);if(e[a][t].minesNear===i)for(var s=0;s<n.length;s++){var r=n[s],l=e[r[1]][r[0]];if(l.state===p.b.MARKED&&!1===l.isMine)return this.triggerLoss(),{mineRevealed:!0,mines:e};var o=e[r[1]][r[0]];if(o.state===p.b.HIDDEN){if(o.isMine)return this.triggerLoss(),{mineRevealed:!0,mines:e};o.state=p.b.REVEALED;var u=this.revealNear(e,r[0],r[1]);!1===u.mineRevealed&&(e=u.mines)}}return{mineRevealed:!1,mines:e}}},{key:"triggerLoss",value:function(){this.setState(function(e){return{mines:e.mines.map(function(e){return e.map(function(e){var t=Object(d.a)({},e);return!1===t.isMine&&t.state===p.b.MARKED&&(t.customClasses+=" falseMark"),t.state===p.b.HIDDEN&&(t.customClasses+=" after"),!0===t.isMine&&t.state===p.b.MARKED||(t.state=p.b.REVEALED),t})})}})}},{key:"handleClick",value:function(e,a){var n=this,i=this.state.mines;if(!0===this.firstClick)this.setState(function(t){for(var i=[],s=0;s<t.mines.length;++s)for(var r=0;r<t.mines[s].length;++r)r===e&&s===a||i.push([r,s]);for(var l=0;l<n.props.numMines;++l){var o=Math.floor(Math.random()*i.length),u=i[o];i.splice(o,1),t.mines[u[1]][u[0]].isMine=!0,n.getMinesToTest(u[0],u[1]).forEach(function(e){++t.mines[e[1]][e[0]].minesNear})}return{mines:t.mines}},function(){n.firstClick=!1,n.handleClick(e,a)});else if(this.props.playing===p.a.IN_PROGRESS&&this.state.mines[a][e].state!==p.b.MARKED)if(i[a][e].state=p.b.REVEALED,i[a][e].isMine)this.props.updateState({playing:p.a.LOSS}),i[a][e].customClasses+=" mineLossClick",this.setState({mines:i},this.triggerLoss);else{var s=this.revealNear(i,e,a);if(!0===s.mineRevealed)this.props.updateState({playing:p.a.LOSS}),this.triggerLoss();else if(0===t.validSquaresLeft(s.mines)){this.props.updateState({playing:p.a.WIN});var r=localStorage.getItem("scores").split(",");r=r.map(function(e){return parseFloat(e)}),console.log(r),r.push(this.timer.getTime()),r.sort(),r.splice(10),localStorage.setItem("scores",r),console.log(localStorage.getItem("scores").split(",")),this.setState({mines:s.mines.map(function(e){return e.map(function(e){var t=e;return!0===t.isMine&&(t.state=p.b.MARKED),t})}),hasFinished:!0})}else this.setState({mines:s.mines})}}},{key:"handleRightClick",value:function(e,t){var a=this;if(this.props.playing===p.a.IN_PROGRESS){var n=this.state.mines[t][e];n.state!==p.b.REVEALED&&this.setState(function(i){return n.state===p.b.MARKED?(i.mines[t][e].state=p.b.HIDDEN,--a.markedNum):(i.mines[t][e].state=p.b.MARKED,++a.markedNum),{mines:i.mines}})}}},{key:"render",value:function(){var e,a,n,s,r,l,o=this,u=this.props,h=u.width,m=u.height,c=u.numMines,d=u.playing;(a=!0===this.firstClick?0:100-100*t.validSquaresLeft(this.state.mines)/(m*h-c),d===p.a.PAUSE)?e=i.a.createElement("div",null,"Paused",i.a.createElement("br",null),i.a.createElement("button",{onClick:function(){o.props.updateState({playing:p.a.IN_PROGRESS}),o.firstClick||o.timer.resume()}},"Resume")):(d===p.a.IN_PROGRESS?(s=i.a.createElement("div",{className:"status"},i.a.createElement("div",null,"Mines Left: ",Math.max(this.props.numMines-this.markedNum,0)),i.a.createElement("div",null,"Progress:",i.a.createElement("div",{className:"bar"},i.a.createElement("div",{className:"innerBar",style:{width:"".concat(a,"%")}},Math.round(10*a)/10,"%")))),n=i.a.createElement("button",{onClick:this.props.updateState.bind(this,{playing:p.a.PAUSE})},"Pause")):n=i.a.createElement("button",{onClick:this.props.updateState.bind(this,{playing:p.a.INPUT})},"Restart"),d===p.a.WIN?r=i.a.createElement("div",{className:"status win"},"Good job!"):d===p.a.LOSS&&(r=i.a.createElement("div",{className:"status"},"You lost!")),l=80/this.props.width<80/this.props.height?"".concat(80/this.props.width,"vw"):"".concat(80/this.props.height,"vh"),e=i.a.createElement("div",null,i.a.createElement("div",{className:"board"},this.state.mines.map(function(e,t){return i.a.createElement("div",{className:"row",key:t},e.map(function(e,a){return i.a.createElement(f,{key:a,mine:e,handleClick:function(){o.handleClick(a,t)},mineSize:l,handleRightClick:function(e){e.preventDefault(),o.handleRightClick(a,t)}})}))})),s,r,n,i.a.createElement("br",null),i.a.createElement("button",{onClick:function(){o.setState(function(e){return{showHelp:!e.showHelp}})}},"Toggle Help"),this.state.showHelp&&i.a.createElement("p",{className:"help"},"At the start screen, enter your desired width, height, and number of mines for your game. The board cannot be wider than the screen, and the number of mines must be less than the total number of squares; play will not commence until these requirements are met. Default is a 30x15 board with 75 mines.",i.a.createElement("br",null),i.a.createElement("br",null),"Clicking on untested squares reveals them. Right-clicking on a square flags it as a mine as a `!`, but is not required.",i.a.createElement("br",null),i.a.createElement("br",null),"If a mine is revealed, the game will end immediately as a loss, all mines are revealed, and the triggered mine will flash blue and red.",i.a.createElement("br",null),i.a.createElement("br",null),"Clicking on a square with the same number of flagged squares adjacent to it as number of mines adjacent to it (ex: any square with no adjacent mines and no adjacent flagged squares, or a `2` with 2 adjacent flagged sqaures) automatically reveals all non-flagged adjacent squares. If a mine is revealed at an adjacent square (due to a misflagged square), the misflagged square flashes blue and red and the game follows the same loss conditions as above. If any of the revealed squares satisfies the same condition, that square will reveal adjacent squares by the same logic. This occurs repeatedly until no squares that are revealed that satisfy this condition.",i.a.createElement("br",null),i.a.createElement("br",null),"When all non-mine squares have been revealed, the game ends in victory.",i.a.createElement("br",null),i.a.createElement("br",null),"A timer above the board indicates how long the game has lasted; this stops immediately on victory or loss. A counter below the board indicates how many mines are left based on the number of flagged squares (number of total mines - number of flagged squares), but never dips below 0. This is simply based on flagged squares, and does not indicate whether or not those flags are correct. Below this counter is a progress bar indicating how many of the non-mine squares have been revealed.")));return this.state.hasFinished&&(e=i.a.createElement(b,{updateState:this.props.updateState.bind(this)})),i.a.createElement("div",null,!this.firstClick&&i.a.createElement(g,{running:d===p.a.IN_PROGRESS,display:d!==p.a.PAUSE&&d!==p.a.WIN,ref:function(e){o.timer=e}}),e)}}],[{key:"validSquaresLeft",value:function(e){return e.reduce(function(e,t){return e+t.reduce(function(e,t){return t.state===p.b.HIDDEN&&!1===t.isMine?e+1:e},0)},0)}}]),t}(i.a.Component);function E(e){var t=e.handleInputChange,a=e.handleSubmit,n=e.height,s=e.numMines,r=e.width;return i.a.createElement("form",{onSubmit:a.bind(this)},i.a.createElement("label",null,"Board width ",i.a.createElement("input",{type:"number",min:1,max:Math.floor(window.innerWidth/6),value:r,name:"width",onChange:t.bind(this)})),i.a.createElement("label",null,"Board height ",i.a.createElement("input",{type:"number",min:1,value:n,name:"height",onChange:t.bind(this)})),i.a.createElement("label",null,"Number of mines ",i.a.createElement("input",{type:"number",min:1,max:r*n-1,value:s,name:"numMines",onChange:t.bind(this)})),i.a.createElement("input",{type:"submit",value:"Play!"}))}var S=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(h.a)(this,Object(m.a)(t).call(this,e))).state={height:15,numMines:75,playing:p.a.INPUT,width:30},a}return Object(c.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("blur",function(){e.state.playing===p.a.IN_PROGRESS&&e.setState({playing:p.a.PAUSE})})}},{key:"updateState",value:function(e){this.setState(e)}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.setState({playing:p.a.IN_PROGRESS})}},{key:"handleInputChange",value:function(e){this.setState(Object(l.a)({},e.target.name,e.target.value))}},{key:"render",value:function(){return this.state.playing===p.a.INPUT?i.a.createElement(E,{width:this.state.width,height:this.state.height,numMines:this.state.numMines,handleSubmit:this.handleSubmit.bind(this),handleInputChange:this.handleInputChange.bind(this)}):i.a.createElement(v,{width:this.state.width,height:this.state.height,numMines:this.state.numMines,playing:this.state.playing,updateState:this.updateState.bind(this)})}}]),t}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(i.a.createElement(S,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[11,2,1]]]);
//# sourceMappingURL=main.60d89248.chunk.js.map